@inject AppState State

<MudThemeProvider Theme="@Theme" IsDarkMode="true" />
<MudPopoverProvider/>
<MudDialogProvider />
<MudSnackbarProvider />
<MudBreakpointProvider />

@code
{
    private MudTheme Theme { get; set; }

    protected override void OnInitialized()
    {
        if (State.App != null)
        {
            Theme = GetThemeFor(State.App);
        }
        State.PropertyChanged += (s, e) =>
        {
            if (e.PropertyName == nameof(State.App))
            {
                Theme = GetThemeFor(State.App);
                StateHasChanged();
            }
        };
    }

    private MudTheme GetThemeFor(AppDetailedDTO app)
    {
        return new MudTheme()
        {
            PaletteDark = new MudBlazor.PaletteDark()
            {
                Black = "#000000",
                White = "#ffffff",
                
                Background = (app?.BackgroundColor ?? "rgb(0,0,0)"),
                BackgroundGray = (app?.BackgroundColor ?? "rgb(0,0,0)"),

                Surface = (app?.SurfaceColor ?? "#333333"),
                DrawerBackground = (app?.SurfaceColor ?? "#333333"),
                DrawerText = "#dddddd",
                DrawerIcon = "#dddddd", 

                AppbarBackground = "rgb(51,51,51)",
                AppbarText = "rgb(255,255,255)",
                
                TextPrimary = "#eeeeee",
                TextSecondary = "#dddddd",
                TextDisabled = "#666666",
                
                Primary = (app?.PrimaryColor ?? "#66c0f4"), // Steam blue
                PrimaryContrastText = "#111111",
                Secondary = (app?.SecondaryColor ?? "#9B9B9B"), // Steam grey
                SecondaryContrastText = "#111111",
                Tertiary = (app?.TertiaryColor ??  "#66c0f4"), // Steam blue
                TertiaryContrastText = "#111111",
                
                Info = "#1976d2",
                InfoContrastText = "#111111",
                Success = "#388e3c",
                SuccessContrastText = "#111111",
                Warning = "#ffa000",
                WarningContrastText = "#111111",
                Error = "#d32f2f",
                ErrorContrastText = "#111111",
                Dark = "#171a21", // Steam dark
                DarkContrastText = "#eeeeee",
                
                //GrayDefault = null,
                //GrayLight = null,
                //GrayLighter = null,
                //GrayDark = null,
                //GrayDarker = null,
                
                //OverlayDark = "rgba(0,0,0, 0.4)",
                //OverlayLight = "rgba(0,0,0, 0.8)"
                
                ActionDisabledBackground = "rgba(255,255,255, 0.12)",
                ActionDisabled = "rgba(255,255,255, 0.26)",
                ActionDefault = "#adadb1",
                
                LinesDefault = "rgba(255,255,255, 0.12)",
                LinesInputs = "rgba(255,255,255, 0.3)",
                Divider = "rgba(255,255,255, 0.12)",
                DividerLight = "rgba(255,255,255, 0.06)",
                TableLines = "rgba(255,255,255, 0.12)",
                //TableHover = null,
                //TableStriped = null,
                
                HoverOpacity = 0.2d
            }
        };    
    }

}
